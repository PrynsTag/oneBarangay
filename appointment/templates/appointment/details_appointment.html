<!DOCTYPE html>

{% extends "layouts/base.html" %}

{% load poll_extras %}

{% block title %}
    Barangay Admin - Details Appointment
{% endblock %}

{% block content %}
    <h1>Appointment Details</h1>

    <a href="{% url "appointment:appointment_resched" user_detail.document_id reschedule %}">Reschedule
        Appointment</a>

    <ul>
        <li>Status: {{ user_detail.status }}</li>
        <li>Name:
            <ul>
                <li>First Name: {{ user_detail.first_name }}</li>
                <li>Middle Name: {{ user_detail.middle_name }}</li>
                <li>Last Name: {{ user_detail.last_name }}</li>
            </ul>
        </li>
        <li>Account Type: {{ user_detail.account_type }}</li>
        <li>Contact Number: {{ user_detail.contact_no }}</li>
    </ul>

    <ul>
        <li>Appointment Date: {{ user_detail.start_appointment|firebase_datetime_format:8 }}</li>
        <li>Appointment Time: {{ user_detail.start_appointment|firebase_timestamp_format:8 }}
            to {{ user_detail.end_appointment|firebase_timestamp_format:8 }}</li>
        <li>
            Document Type:
            <ul>
                <li>{{ user_detail.document|join_dict:"document_name" }}</li>
            </ul>
        </li>
        <li>Total Amount: {{ amount }}</li>
        <li>Purpose: {{ user_detail.appointment_purpose }}</li>
    </ul>

    <ul>
        <li><img src="{{ user_detail.appointment_image }}" alt="ID Verification"></li>
    </ul>

    <form action="{% url "appointment:id_verification" user_detail.document_id %}" method="POST">
        {% csrf_token %}
        {{ form }}
        <input type="submit" name="submit" value="Search">
    </form>

    {% if user_check %}
        {% if user_verified %}
            <h2>User was verified.</h2>

            <table>
                <tr>
                    <th>First Name</th>
                    <th>Middle Name</th>
                    <th>Last Name</th>
                </tr>
                {% for user in user_list %}
                    <tr>
                        <td>{{ user.first_name }}</td>
                        <td>{{ user.middle_name }}</td>
                        <td>{{ user.last_name }}</td>
                    </tr>
                {% endfor %}
            </table>

            <a href="{% url "appointment:user_verify" document_id %}">Confirm</a>
            <a href="{% url "appointment:view_appointments" back %}">Back</a>
        {% else %}
            <table>
                <tr>
                    <th>First Name</th>
                    <th>Middle Name</th>
                    <th>Last Name</th>
                </tr>
                {% for user in user_list %}
                    <tr>
                        <td>
                            <!-- FIXME: Reconfigure this change the url to request but show only the value that was clicked in table -->
                            <a href="{% url "appointment:id_verification_manual" user.uid document_id %}">{{ user.first_name }}</a>
                        </td>
                        <td>
                            <a href="{% url "appointment:id_verification_manual" user.uid document_id %}">{{ user.middle_name }}</a>
                        </td>
                        <td>
                            <a href="{% url "appointment:id_verification_manual" user.uid document_id %}">{{ user.last_name }}</a>
                        </td>
                    </tr>
                {% endfor %}
            </table>

            <a href="javascript:void(0)">Confirm</a>
            <a href="{% url "appointment:view_appointments" back %}">Back</a>
        {% endif %}
    {% else %}
        <a href="javascript:void(0)">Confirm</a>
        <a href="{% url "appointment:view_appointments" back %}">Back</a>
    {% endif %}
{% endblock %}
